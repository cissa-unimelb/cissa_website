<!DOCTYPE html>
<html lang="en">
  <head>
    <title>CISSA | Events</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta
      name="description"
      content="Computing and Information Systems Students Association | University of Melbourne | Events"
    />
    <meta property="og:title" content="CISSA" />
    <meta
      property="og:description"
      content="Check out our upcoming events"
    />
    <meta property="og:image" content="/og-image.jpg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:url" content="https://cissa.org.au/events.html" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="CISSA" />
    <meta
      name="twitter:description"
      content="Stay up to date with UniMelbâ€™s Premier Tech Club"
    />
    <meta
      name="twitter:image"
      content="https://cissa.org.au/twitter-card.png"
    />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="/android-chrome-192x192.png"
    />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#33d4c8" />
    <meta name="apple-mobile-web-app-title" content="CISSA" />
    <meta name="application-name" content="CISSA" />
    <meta name="msapplication-TileColor" content="#2b5797" />
    <meta name="msapplication-TileImage" content="/mstile-144x144.png" />
    <meta name="theme-color" content="#000a25" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.4.1/css/all.css"
      integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/shards-ui@2.1.0/dist/css/shards.min.css"
      integrity="sha256-eQoOeIG21g39EkgM218wqO3pF/maNq222vMz7Yxowv4="
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/shards-ui@2.1.0/dist/css/shards-extras.min.css"
      integrity="sha256-8EIZIimb8h9VjDK6M/cgkJkW3aERTk6BFBTECXWMsI0="
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="assets/css/main.css"/>

  </head>

 <body onload = "call()" class="event-page shards-landing-page--1">
    <div id="head" class="d-flex justify-content-center flex-column">
      <nav class="navbar navbar-expand-lg fixed-top navbar-dark pt-4 px-5">
        <a class="navbar-brand" href="index.html"
          ><img
            src="assets/images/cissa_white.svg"
            width="100px"
            class="mb-2"
            alt="CISSA"
          />
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarNavDropdown"
          aria-controls="navbarNavDropdown"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse mb-2" id="navbarNavDropdown">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Events
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="events.html">Upcoming Events</a>
                <a class="dropdown-item" href="gallery.html">Gallery</a>
              </div>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="about.html">Committee</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="sponsors.html">Sponsors</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://medium.com/cissa-unimelb">Blog</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="contact.html">Contact</a>
            </li>
            <li class="nav-item">
              <a class="nav-link signup" href="https://cissa.org.au/signup">Join Us</a>
            </li>
          </ul>
        </div>
      </nav>

      <header>
        <h1 class="section-title text-center">EVENTS</h1>
      </header>
    </div>

    <div class="text-center no-pastevents-msg pt-5"></div>
    <div class="row events-from-fb text-center py-5"> 
      <div class="fa-3x text-center col-md-12"><i class="fas fa-circle-notch fa-spin"></i></div>
    </div>




    <h5 class="text-center py-5">
    Check out our past events <a href="past_events.html">here</a>
    </h5>

    <div class="row dark text-center d-flex justify-content-center footer pt-5 pb-3">
      <div class="footer-img col-md">
        <a class="fab fa-medium-m social" href="https://medium.com/cissa-unimelb">
        </a>
        <a class="fab fa-facebook-f social" href="https://www.facebook.com/cissa.unimelb/">
        </a>
        <a class="fab fa-instagram social" href="https://instagram.com/cissa_unimelb/">
        </a>
        <a class="fab fa-twitter social" href="https://twitter.com/cissa_unimelb/">
        </a>
        <a class="fab fa-discord social" href="https://discord.gg/JZXcbQf5">
        </a>
      </div>
      <p class="col-md-12 mt-5">Copyright &copy; 2021 CISSA<p>
    </div>


    <script>
      async function getData(url){
        const response = await fetch(url);
        return response.json();
      }

      function processData(data) {
        var counter = 0;
        var now = new Date();
        var elems = {};
        for (var event of data) {
          var date = new Date(event.start_time);
          if(date.getTime() < now.getTime()) {
            continue;
          }
          var cover_photo = event.cover.source;
          var time = date.toLocaleString('en-AU', {
            year: 'numeric', 
            month: 'long', 
            day: 'numeric',
            hour: 'numeric',
            minute: 'numeric'
          });
          var name = event.name != null ? event.name :  "";
          var location = event.place != null ? event.place.name : "Online";
          var descr = event.description != null ? event.description.replace(/(?:\r\n|\r|\n)/g, '<br>') : "";
          var event_id = event.id;

          elems[date.getTime()] = `
            <div class='col-md-6'>
              <div class='event-img text-center py-5'>
                <img src='${cover_photo}'' alt='Photo'/>
              </div>
              <div class='event-descr pt-1 pb-5'>
                <h4>
                  <a style="color: black;" href='https://www.facebook.com/events/${event_id}'>${name}</a>
                </h4>
                <div>${location}</div>
                <div>${time}</div>
              </div>
            </div>
          `;
          counter++;
        }
        var keys = Object.keys(elems).sort();
        for(var key of keys) {
          $(".events-from-fb" ).prepend(elems[key]);
        }
        if(counter == 0){
          $(".no-pastevents-msg" ).prepend("<p class='no-events'>There are no upcoming events.\
          Check out our <a target='_blank' href='https://www.facebook.com/cissa.unimelb/events/'>facebook page</a> for more!</p>");
        }
      }

      async function call(){
        const data = getData("/fetch-events")
        .then(data => {
          processData(data);
          $(".fa-3x").hide();
        })
        .catch((error) => {
          $(".no-events-msg" ).prepend("<p class='no-events'>There are no upcoming events.\
            Check out out <a target='_blank' href='https://www.facebook.com/cissa.unimelb/events/'>facebook page</a> for more!</p>");
            $(".fa-3x").hide();
        });
      }
    </script>

    <script
        src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"
        ></script>
        <script
        src="https://cdn.jsdelivr.net/npm/popper.js@1.14.4/dist/umd/popper.min.js"
        integrity="sha256-EGs9T1xMHdvM1geM8jPpoo8EZ1V1VRsmcJz8OByENLA="
        crossorigin="anonymous"
        ></script>
        <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"
        ></script>
        <script
        src="https://cdn.jsdelivr.net/npm/shards-ui@2.1.0/dist/js/shards.min.js"
        integrity="sha256-PCFtnjaRohL1L6wEpWGaVacPmSQOoqYC4YDDRKC6RUc="
        crossorigin="anonymous"
        >
    </script>

  </body>
</html>
